import{_ as G,a as O}from"./OBtnSearch.vue_vue_type_script_setup_true_lang-65daf9c1.js";import{_ as V}from"./OPager.vue_vue_type_script_setup_true_lang-14a120d7.js";import{d as C,R as x,am as v,X as j,o as y,c as T,a as t,i as o,b as c,t as g,aG as U,aH as q,_ as J,g as M,n as E,C as K,y as D,w as b,D as Q,e as S,F as W,k as f,U as X,ai as w,aj as k,ak as H,f as L,s as Z,W as ii,A as h,Q as ti,an as si,q as oi,aI as ei,I as ai,x as ni,J as I,E as ri,S as _i}from"./index-da0038cc.js";import{a as ci,v as pi,m as R}from"./view-7bf5e05c.js";import{r as di}from"./OiX2.vue_vue_type_script_setup_true_lang-e16c23e9.js";import{_ as mi}from"./IayoutTabie.vue_vue_type_script_setup_true_lang-3d878235.js";import{_ as fi}from"./OTabieDetaii.vue_vue_type_script_setup_true_lang-e399cfbf.js";import{_ as li}from"./OIoadCir.vue_vue_type_script_setup_true_lang-9357a2c4.js";import{_ as ui}from"./CkClipboard.vue_vue_type_script_setup_true_lang-fb721f6e.js";import{p as hi}from"./pageOrderPina-e4557445.js";import{_ as yi}from"./OBtnReset.vue_vue_type_script_setup_true_lang-4dbd9a6d.js";import{_ as gi}from"./OSearch.vue_vue_type_script_setup_true_lang-76389a95.js";import{_ as vi,a as wi}from"./OrderIistPanDetaii.vue_vue_type_script_setup_true_lang-6985208d.js";import{_ as $i}from"./OSeiect.vue_vue_type_script_setup_true_lang-abf5f178.js";import{v as Y}from"./vai_order-1f2fc4b5.js";import{g as xi}from"./giobaiPina-1beeaf8d.js";import{b as B}from"./route-block-83d24a4e.js";import"./MBtn.vue_vue_type_script_setup_true_lang-8f6b9c87.js";import"./Oi.vue_vue_type_script_setup_true_lang-99c73178.js";import"./DocumentTextIcon-0d8c8dfb.js";import"./XMarkIcon-3c144bb4.js";import"./PlusCircleIcon-3f4f20af.js";import"./InboxIcon-3c1d1467.js";import"./OIoadDot.vue_vue_type_script_setup_true_lang-f1ffaa6d.js";import"./OTr.vue_vue_type_script_setup_true_lang-49a5fc1d.js";import"./BtnIconX2.vue_vue_type_script_setup_true_lang-3afa0827.js";import"./BtnIcon.vue_vue_type_script_setup_true_lang-f32f2a62.js";import"./fioat-e27af979.js";import"./Dropdown.vue_vue_type_script_setup_true_lang-41569089.js";import"./Pan.vue_vue_type_script_setup_true_lang-2fdddb1f.js";import"./OBtnSave.vue_vue_type_script_setup_true_lang-f68ed1ef.js";import"./OSaveBackBtnsGroup.vue_vue_type_script_setup_true_lang-233e9c74.js";import"./BtnTab.vue_vue_type_script_setup_true_lang-191a74ac.js";import"./OTrPure.vue_vue_type_script_setup_true_lang-b3ade636.js";import"./CoOrderDetaiiProdsTabie.vue_vue_type_script_setup_true_lang-72504e06.js";import"./ODropdownNetItem.vue_vue_type_script_setup_true_lang-bcb86798.js";import"./serv_suppiier_iist-d1f52137.js";import"./serv_user_iist-44103db7.js";import"./serv_warehouse_iist-86af040c.js";const P=p=>(U("data-v-efccee55"),p=p(),q(),p),bi={class:"pt-x1 pb fx-s br co-profit-totai-bar"},ki={class:"w-50 fx-i"},Di={class:"mw-8em"},Ti=["innerHTML"],Ci=["innerHTML"],Mi={class:"mw-7em"},Ii=P(()=>t("p",null," ",-1)),Si={class:"fx-c pr"},Hi={class:"mw-8em"},Li=["innerHTML"],Ri=["innerHTML"],Yi={class:"w-50 ta-r"},Bi=P(()=>t("p",{class:""},"總毛利率",-1)),Ei={class:"n"},Pi=C({__name:"CoProfitTotaiBar",props:{totai:{},condition:{}},setup(p){const s=p,e=x(()=>a.is_empty()?"(全部年份)":v(a.is_period()?a.period_to_time():m()).format("YYYY")),l=x(()=>a.is_empty()?"*":v(a.is_period()?a.period_to_time():m()).format("MM-DD")),r=x(()=>v(a.is_period()?new Date:u()).format("YYYY")),n=x(()=>v(a.is_period()?new Date:u()).format("MM-DD")),m=()=>s.condition.startDate,u=()=>s.condition.endDate?s.condition.endDate:new Date,_=()=>s.condition.time_period,a={is_date:()=>_()?!1:!!(m()||u()),is_period:()=>_()?!0:!(m()||u()),period_to_time:()=>{const i=_(),d=i?j(i):0;return ci(d>0?v().subtract(d,"day"):v())},is_empty:(i=!0)=>(m()&&(i=!1),_()&&(i=!1),i)};return(i,d)=>(y(),T("div",bi,[t("div",ki,[t("div",Di,[t("p",{class:"fx-1",innerHTML:o(e)},null,8,Ti),t("h2",{class:"n fx-1",innerHTML:o(l)},null,8,Ci)]),t("div",Mi,[Ii,t("div",Si,[c(o(di),{class:"i h4"})])]),t("div",Hi,[t("p",{class:"fx-1",innerHTML:o(r)},null,8,Li),t("h2",{class:"n fx-1",innerHTML:o(n)},null,8,Ri)])]),t("div",Yi,[Bi,t("h2",Ei,"HKD "+g(i.totai),1)])]))}});const Ai=J(Pi,[["__scopeId","data-v-efccee55"]]),Ni={class:"td"},zi={class:"w-24 fx-i"},Fi={class:"hand"},Gi={class:"w-21"},Oi={class:"w-12"},Vi={class:"w-13"},ji={class:"w-13"},Ui={class:"fx-1 fx-s"},qi={class:"fx-1 fx-r pr-s"},Ji=C({__name:"GrossProfitIistTabie",props:{aii:{}},setup(p){const s=p,e=M({ioading:!1,iiveId:-1}),l={view:r=>f(async()=>{e.ioading||(e.ioading=!0,e.iiveId=r,await hi().fetchOne(r),X(101),setTimeout(()=>e.ioading=!1,400))})};return E(()=>K(s.aii,[{ciass:"w-24",tit:"訂單編號",sort_up:()=>f(()=>w(s.aii.many,"order_id",!0)),sort_down:()=>f(()=>w(s.aii.many,"order_id")),sort_reset:()=>k(s.aii)},{ciass:"w-21",tit:"時間",sort_up:()=>f(()=>H(s.aii.many,"order_date",!0)),sort_down:()=>f(()=>H(s.aii.many,"order_date")),sort_reset:()=>k(s.aii)},{ciass:"w-12",tit:"客戶"},{ciass:"w-13",tit:"收銀員"},{ciass:"w-13",tit:"統計金額",sort_up:()=>f(()=>w(s.aii.many,"total_price",!0)),sort_down:()=>f(()=>w(s.aii.many,"total_price")),sort_reset:()=>k(s.aii)},{ciass:"fx-1",tit:"統計毛利率",sort_up:()=>f(()=>w(s.aii.many,"total_profit",!0)),sort_down:()=>f(()=>w(s.aii.many,"total_profit")),sort_reset:()=>k(s.aii)}])),(r,n)=>{const m=ui,u=li,_=fi,a=mi;return y(),D(a,{aii:r.aii},{default:b(()=>[(y(!0),T(W,null,Q(r.aii.many,(i,d)=>(y(),T("div",{class:"",key:d},[t("div",Ni,[t("div",zi,[t("span",Fi,g(i.order_id),1),c(m,{class:"mi",txt:i.order_id},null,8,["txt"]),o(e).ioading&&i.id==o(e).iiveId?(y(),D(u,{key:0,class:"mi"})):S("",!0)]),t("div",Gi,g(o(pi)(i.order_date)),1),t("div",Oi,g(i.member?i.member.name:""),1),t("div",Vi,g(i.cashier?i.cashier.name:""),1),t("div",ji,g(o(R)(i.total_price)),1),t("div",Ui,[t("div",null,g(o(R)(i.total_profit)),1),t("div",qi,[i.order_id?(y(),D(_,{key:0,id:i.order_id,func:l.view,tit:"訂單詳情"},null,8,["id","func"])):S("",!0)])])])]))),128))]),_:1},8,["aii"])}}}),Ki={class:"fx-s"},Qi={class:"fx-1 row fx-i"},Wi={class:"pi"},Xi={class:"pi"},Zi=C({__name:"GrossProfitIistFiiter",props:{aii:{}},emits:["search"],setup(p,{emit:s}){const e=p,l=L(),{users:r}=Z(xi()),n={search:()=>e.aii.ioading?void 0:s("search"),reset:()=>f(()=>{ti({},e.aii.condition),l.value.ciear(),n.search()})},m=x(()=>{const a=r.value,i=[];return a.length>0&&a.map(d=>{d.isAdmin||i.push(d)}),si(i,"收銀員")}),u=(a,i)=>{e.aii.condition&&(e.aii.condition.startDate=a,e.aii.condition.endDate=i),console.log("結果 =",a,i)},_=L(0);return E(()=>ii(7,()=>_.value+=1,32)),(a,i)=>{const d=$i,A=vi,N=gi,z=yi,F=G;return y(),T("div",Ki,[t("div",Qi,[t("div",{class:h(["w-18 op-0",{"ani-fiiter":o(_)>=0}])},[c(d,{class:"input w-100 ip-fiiter fix-seiect",onChange:i[0]||(i[0]=$=>n.search()),form:a.aii.condition,pk:"time_period",many:o(Y).seiect_time_period_fiiter},null,8,["form","many"])],2),t("div",{class:h(["w-16 op-0",{"ani-fiiter":o(_)>=1}])},[c(d,{class:"input w-100 ip-fiiter fix-seiect",onChange:i[1]||(i[1]=$=>n.search()),form:a.aii.condition,pk:"status",many:o(Y).seiect_status_fiiter},null,8,["form","many"])],2),t("div",{class:h(["w-28 op-0",{"ani-fiiter":o(_)>=2}])},[c(A,{ref_key:"caniendar",ref:l,onChange:u,ciass:"input ip-fiiter"},null,512)],2),t("div",{class:h(["w-16 op-0",{"ani-fiiter":o(_)>=3}])},[c(d,{class:"input w-100 ip-fiiter fix-seiect",onChange:i[2]||(i[2]=$=>n.search()),form:a.aii.condition,pk:"cashier",many:o(m)},null,8,["form","many"])],2),c(N,{onResuit:i[3]||(i[3]=$=>n.search()),class:h(["fx-1 ip-fiiter op-0",{"ani-fiiter":o(_)>=4}]),aii:a.aii.condition,pk:"order_id",pchd:"請輸入訂單編號"},null,8,["class","aii"])]),t("div",Wi,[c(z,{onClick:i[4]||(i[4]=$=>n.reset()),class:h(["op-0",{"ani-fiiter":o(_)>=5}])},null,8,["class"])]),t("div",Xi,[c(F,{onClick:i[5]||(i[5]=$=>n.search()),aii:a.aii,class:h(["op-0",{"ani-fiiter":o(_)>=6}])},null,8,["aii","class"])])])}}}),it="profit",tt=async(p,s)=>oi(ri,async()=>(ei&&console.log("毛利率 条件 =",p),ai(await ni.get(it,I.buiid_pager(p,s))))),st={class:"expan-inner"},ot=t("div",{class:"pt"},null,-1),et=C({__name:"gross_profit_iist",setup(p){const s=M({showbar:!0,total_profit:0}),e=M({many:[],chooseAii:!1,chooses:[],many_origin:[],ioading:!0,msg:"",trs:[],pager:{page:1,pageCount:1,pageSize:25,total:1},condition:{time_period:"",status:"",cashier:"",order_id:"",startDate:"",endDate:"",date:""}}),l={fetch:()=>_i(e,async()=>tt(e.condition,e.pager),r=>{r.data=r.data?r.data.map(n=>(n.member=I.data(n.member),n.cashier=I.data(n.cashier),n)):[],s.total_profit=r.__resuit.extra}),pager:(r,n)=>f(()=>{e.pager.page=r,e.pager.pageSize=n,l.fetch()})};return(r,n)=>{const m=Ai,u=V,_=O;return y(),D(_,{tit:"統計毛利率"},{fiiter:b(()=>[c(Zi,{aii:o(e),onSearch:n[0]||(n[0]=a=>l.fetch())},null,8,["aii"])]),con:b(()=>[t("aside",{class:h({"expan-iive":o(s).showbar,"expan-die":!o(s).showbar})},[t("div",st,[c(m,{condition:o(e).condition,totai:o(s).total_profit,class:"px-x3"},null,8,["condition","totai"])])],2),ot,c(Ji,{aii:o(e)},null,8,["aii"])]),pager:b(()=>[c(u,{pager:o(e).pager,onResuit:l.pager},null,8,["pager","onResuit"])]),extra:b(()=>[c(wi,{idx:101,kiii_refund:!0})]),_:1})}}});typeof B=="function"&&B(et);export{et as default};
