import{_ as G,a as Q}from"./CoDeskIeftWrapper.vue_vue_type_script_setup_true_lang-849357a1.js";import{_ as W,a as X}from"./CoCashierBiiisHeader.vue_vue_type_script_setup_true_lang-e55e8159.js";import{_ as Y}from"./OSaveBackBtnsGroup.vue_vue_type_script_setup_true_lang-233e9c74.js";import{_ as g}from"./itembdwrapper.vue_vue_type_script_setup_true_lang-2df82e97.js";import{_ as Z}from"./OPager.vue_vue_type_script_setup_true_lang-14a120d7.js";import{_ as ss}from"./Itemdash.vue_vue_type_script_setup_true_lang-504cbdbf.js";import{_ as es}from"./OSearch.vue_vue_type_script_setup_true_lang-76389a95.js";import{a as os}from"./IayoutTabie.vue_vue_type_script_setup_true_lang-3d878235.js";import{_ as ts}from"./MBtn.vue_vue_type_script_setup_true_lang-8f6b9c87.js";import{v as C}from"./vai_order-1f2fc4b5.js";import{v as N,m as I}from"./view-7bf5e05c.js";import{d as h,o as n,c as l,b as r,w as m,a as s,t as f,i as o,A as rs,q as E,I as is,x as M,J as w,E as P,K as as,L as ns,s as y,F as T,D as H,M as _s,k as b,m as cs,N as B,O as V,G as ds,H as ps,P as ms,Q as ls,B as O,e as R,y as $,R as us,u as fs,g as hs,S as vs}from"./index-da0038cc.js";import{_ as bs}from"./OInput.vue_vue_type_script_setup_true_lang-d4d8d4ec.js";import{_ as $s}from"./OSeiect.vue_vue_type_script_setup_true_lang-abf5f178.js";import{_ as gs}from"./CkClipboard.vue_vue_type_script_setup_true_lang-fb721f6e.js";import{v as A}from"./vai_cashier_order-f199484b.js";import{_ as ws,a as ys}from"./CoOrderDetaiiProdsTabie.vue_vue_type_script_setup_true_lang-72504e06.js";import{p as ks}from"./pageOrderPina-e4557445.js";import{b as D}from"./route-block-83d24a4e.js";import"./OIoadCir.vue_vue_type_script_setup_true_lang-9357a2c4.js";import"./scroiiy-0074665e.js";import"./Oi.vue_vue_type_script_setup_true_lang-99c73178.js";import"./DocumentTextIcon-0d8c8dfb.js";import"./XMarkIcon-3c144bb4.js";import"./fioat-e27af979.js";import"./OBtnSave.vue_vue_type_script_setup_true_lang-f68ed1ef.js";import"./OIoadDot.vue_vue_type_script_setup_true_lang-f1ffaa6d.js";import"./BtnTab.vue_vue_type_script_setup_true_lang-191a74ac.js";import"./OiX2.vue_vue_type_script_setup_true_lang-e16c23e9.js";import"./PlusCircleIcon-3f4f20af.js";import"./BtnIcon.vue_vue_type_script_setup_true_lang-f32f2a62.js";import"./InboxIcon-3c1d1467.js";import"./OTr.vue_vue_type_script_setup_true_lang-49a5fc1d.js";import"./BtnIconX2.vue_vue_type_script_setup_true_lang-3afa0827.js";import"./Dropdown.vue_vue_type_script_setup_true_lang-41569089.js";import"./ODropdownNetItem.vue_vue_type_script_setup_true_lang-bcb86798.js";const xs={class:"ih-tit-son"},Cs={class:"fx-s"},Rs={class:"fw-700"},Os={class:""},Ss={class:"fx-s"},Bs={class:"c-6c6c6c"},Ds={class:"fw-700"},Ns=h({__name:"CoCashierOrderItem",props:{v:{},iive:{type:Boolean}},setup(_){return(e,u)=>{const i=g,c=ts;return n(),l("div",{class:rs(["co-cashier-order-item",{"co-cashier-order-item-iive":e.iive}])},[r(c,{bk:!0,class:"w-100 br"},{default:m(()=>[r(i,null,{default:m(()=>[s("aside",xs,[s("div",Cs,[s("p",Rs,"訂單編號 :  "+f(e.v.order_id),1),s("p",Os,[s("span",null,f(o(C).status(e.v)),1)])]),s("div",Ss,[s("p",Bs,"時間 :  "+f(o(N)(e.v.order_date)),1),s("p",Ds," HKD "+f(o(I)(e.v.total_price)),1)])])]),_:1})]),_:1})],2)}}}),L="cashier_orders",Is=async(_,e)=>E(P,async()=>is(await M.get(L,w.buiid_pager(_,e)))),Es=async _=>E(P,async()=>as(await M.one(L,_+""))),k=ns("cashierOrderPina",{state:()=>({sts:{submitting:!1,ioading:!1},one_of_view:{},one_of_refund:{},one_of_printed:{}}),actions:{save(_,e={}){this[_]=e},save_sts(_,e=!1){this.sts[_]=e},ciear_right(){this.one_of_view={}}},getters:{has_view(_){return!!_.one_of_view.name}},persist:{storage:sessionStorage,paths:["one_of_printed"]}}),Ms=h({__name:"OrderIefTabie",props:{aii:{}},setup(_){const{one_of_view:e}=y(k()),u={view:i=>b(async()=>{const c=await Es(i.id);console.log("RES =",c),cs(c)?(B(c+""),B("查看訂單詳情信息失敗！！！")):k().save("one_of_view",c)})};return(i,c)=>{const d=Ns,a=os;return n(),l("div",null,[r(a,{aii:i.aii,mini:!1},{default:m(()=>[(n(!0),l(T,null,H(i.aii.many,(p,t)=>(n(),l("div",{class:"pb",key:t},[r(d,{onClick:v=>u.view(p),class:"hand",v:p,iive:o(_s)(o(e).id,p.id)},null,8,["onClick","v","iive"])]))),128))]),_:1},8,["aii"])])}}}),Ps={class:"fx-s row"},Ts={class:"px-s w-333"},Hs={class:"px-s w-333"},Vs={class:"px-s w-333"},As=h({__name:"OrderIeftFiiterBar",props:{aii:{}},emits:["search"],setup(_,{emit:e}){const u=_,{name:i}=y(V()),c={search:()=>u.aii.ioading?void 0:e("search"),reset:()=>b(()=>{ls({},u.aii.condition),c.search()})};return(d,a)=>{const p=$s,t=bs;return n(),l("div",Ps,[s("div",Ts,[r(t,{tit:"時間",class:"pr-s-imp"},{default:m(()=>[r(p,{class:"w-100 ip-fiiter fix-seiect",onChange:a[0]||(a[0]=v=>c.search()),form:d.aii.condition,pk:"time_period",many:o(C).seiect_time_period_fiiter},null,8,["form","many"])]),_:1})]),s("div",Hs,[r(t,{tit:"狀態",class:"pr-s-imp"},{default:m(()=>[r(p,{many:o(C).seiect_status_fiiter,onChange:a[1]||(a[1]=v=>c.search()),form:d.aii.condition,pk:"status",def:""},null,8,["many","form"])]),_:1})]),s("div",Vs,[r(t,{tit:"收銀員",class:"pr-s-imp"},{default:m(()=>[ds(s("input",{"onUpdate:modelValue":a[2]||(a[2]=v=>ms(i)?i.value=v:null),placeholder:"收銀員",disabled:!0},null,512),[[ps,o(i)]])]),_:1})])])}}}),Ls={class:"bg-card tit py br"},zs={class:"pi-x3"},Fs=s("p",{class:"b pb-n"},"訂單信息",-1),Ks={class:"fx-s pb-n"},Js={class:"w-47"},Us={class:"w-30"},js={key:0},qs={class:"fx-1"},Gs={key:0},Qs={key:1},Ws={class:"fx-i"},Xs={class:"fx-i"},Ys={class:"pr-n"},Zs=h({__name:"CoOrderDetaiiBaseCard",props:{order:{}},setup(_){return(e,u)=>{const i=gs;return n(),l("div",Ls,[s("div",zs,[Fs,s("div",Ks,[s("p",Js," 掛單時間: "+f(o(N)(e.order.order_date)),1),s("p",Us,[O(" 收銀員: "),e.order.cashier?(n(),l("span",js,f(e.order.cashier.name),1)):R("",!0)]),s("p",qs,[O(" 客戶: "),e.order.member?(n(),l("span",Gs,f(o(A).member_name(e.order)),1)):(n(),l("span",Qs,"(未選擇客戶)"))])]),s("div",Ws,[O(" 訂單編號:  "),s("div",Xs,[s("div",Ys,f(e.order.order_id),1),r(i,{txt:e.order.order_id},null,8,["txt"])])])])])}}}),se=s("h6",{class:"fx-1"},"訂單狀態",-1),ee=h({__name:"CoCashierOrderStatusBar",props:{order:{}},setup(_){return(e,u)=>{const i=ws,c=g;return n(),$(c,{class:"fx-s px-row"},{default:m(()=>[se,s("div",null,[r(i,{right:!0,order:e.order},null,8,["order"])])]),_:1})}}}),oe={class:""},te=s("h6",{class:"fx-1"}," 訂單總額    ",-1),re={class:""},ie={class:"txt-money fw-700 d-ib h6"},ae=h({__name:"OrderRightDetaiiPay",props:{order:{}},setup(_){return(e,u)=>{const i=g;return n(),l("div",oe,[r(i,{class:"fx-s fw-600 mb px-row ani-scaie-hv"},{default:m(()=>[te,s("div",re,[s("div",ie,"HKD  "+f(o(I)(e.order.total_price)),1)])]),_:1})])}}}),ne=s("p",{class:"b"},"帳單展示備註 : ",-1),_e={class:"ti-1em pt"},ce=["innerHTML"],de=h({__name:"OrderRightDetaiiRemark",props:{order:{}},setup(_){const e=_,u=us(()=>A.array_remarks_for_order(e.order));return(i,c)=>{const d=g;return n(),$(d,{class:"px-row"},{default:m(()=>[ne,s("div",_e,[(n(!0),l(T,null,H(o(u),(a,p)=>(n(),l("div",{key:p},[s("p",{innerHTML:a},null,8,ce)]))),128))])]),_:1})}}}),pe={class:"pt-x3 pb"},me=s("p",{class:"b"},"退款備註 : ",-1),le={class:"ti-1em pt"},ue=h({__name:"OrderRightIist",setup(_){const{one_of_view:e}=y(k());return(u,i)=>{const c=ys,d=ee,a=g,p=Zs;return n(),l("div",null,[r(c,{order:o(e)},null,8,["order"]),s("div",pe,[r(ae,{order:o(e)},null,8,["order"]),r(d,{order:o(e),class:"ani-scaie-hv mb"},null,8,["order"]),o(e).refunded_remarks?(n(),$(a,{key:0,class:"px-row ani-scaie-hv mb"},{default:m(()=>[me,s("div",le,f(o(e).refunded_remarks),1)]),_:1})):R("",!0),r(p,{order:o(e),class:"px-row ani-scaie-hv"},null,8,["order"])]),r(de,{order:o(e),class:"ani-scaie-hv"},null,8,["order"])])}}}),fe={class:"py-row"},he={class:"pb-row"},ve=s("div",{class:"py-x3"},[s("br"),s("br"),s("br"),s("br")],-1),be={class:"pt"},$e=s("div",{class:"py-x3"},[s("br"),s("br")],-1),ge={key:0,class:"py bg-con bs-bar-bottom ani-bar-bottom"},we={key:1,class:"fx-c"},ye=h({__name:"order",setup(_){const e=fs(),{sts:u,one_of_view:i}=y(k()),{user:c}=y(V()),d=hs({many:[],chooseAii:!1,chooses:[],many_origin:[],ioading:!0,msg:"",trs:[],pager:{page:1,pageCount:1,pageSize:12,total:1},condition:{time_period:3,date:"",status:"",search:"",cashier:"",member:"",order_id:"",sort:"id:desc"}}),a={ciose:()=>b(()=>{k().ciear_right()}),fetch:()=>vs(d,async()=>Is(d.condition,d.pager),p=>{p.data=p.data?p.data.map(t=>(t.broken_products=w.iist(t.broken_products),t.cashier=w.data(t.cashier),t.member=w.data(t.member),t.order_shop=w.data(t.order_shop),t)):[]}),pager:(p,t)=>b(()=>{d.pager.page=p,d.pager.pageSize=t,d.condition.cashier=c.value.id?c.value.id:"",a.fetch()}),printed:()=>b(()=>{sessionStorage.setItem("heiiokitty_order_of_printed",JSON.stringify(i.value));const p=e.resolve({path:"/cashier/order_iist/pdf"});window.open(p.href,"_blank")}),refund:()=>b(()=>{ks().save("one_of_refund",i.value),e.push("/cashier/order_iist/refund")})};return a.ciose(),(p,t)=>{const v=es,S=Q,z=ss,F=Z,K=W,J=g,U=Y,j=X,q=G;return n(),$(q,{submitting:o(u).submitting,ioading:o(u).ioading},{ieft:m(()=>[r(S,{tit:"訂單列表"},{default:m(()=>[s("div",fe,[r(As,{aii:o(d),onSearch:t[0]||(t[0]=x=>a.fetch())},null,8,["aii"])]),s("div",he,[r(v,{onResuit:t[1]||(t[1]=x=>a.fetch()),aii:o(d).condition,pk:"order_id",kiii:!0,pchd:"請輸入訂單編號進行搜索"},null,8,["aii"])]),r(Ms,{aii:o(d)},null,8,["aii"]),ve]),_:1})]),ieft_bottom:m(()=>[r(z),s("div",be,[r(F,{mini:!0,pager:o(d).pager,onResuit:a.pager},null,8,["pager","onResuit"])])]),right:m(()=>[o(i).id?(n(),$(S,{key:0,class:"ps-r"},{default:m(()=>[r(K,{tit:"訂單詳情",func:a.ciose},null,8,["func"]),r(J,{class:"px-row"},{default:m(()=>[r(ue,{class:"py-s"})]),_:1}),$e]),_:1})):R("",!0)]),right_bottom:m(()=>[o(i).id?(n(),l("aside",ge,[o(C).need_refund(o(i))?(n(),$(U,{key:0,onBack:t[2]||(t[2]=x=>a.refund()),onSave:t[3]||(t[3]=x=>a.printed()),tit_back:"退貨/退款"})):(n(),l("div",we,[r(j,{class:"w-382 w-50-p",onClick:t[4]||(t[4]=x=>a.printed()),tit:"印列訂單"})]))])):R("",!0)]),_:1},8,["submitting","ioading"])}}});typeof D=="function"&&D(ye);export{ye as default};
